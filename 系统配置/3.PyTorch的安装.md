# PyTorch和CUDA的配置

## 检查系统驱动
查看本机显卡驱动安装情况
```
nvidia-smi
```

输出实例
```
Fri Sep 26 20:05:42 2025       
+-----------------------------------------------------------------------------------------+ 
| NVIDIA-SMI 580.82.09              Driver Version: 580.82.09      CUDA Version: 13.0     |   // [!code warning]
+-----------------------------------------+------------------------+----------------------+ 
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC | 
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. | 
|                                         |                        |               MIG M. | 
|=========================================+========================+======================| 
|   0  NVIDIA GeForce RTX 5060 Ti     Off |   00000000:01:00.0  On |                  N/A | 
|  0%   50C    P8              8W /  180W |     399MiB /  16311MiB |      0%      Default | 
|                                         |                        |                  N/A | 
+-----------------------------------------+------------------------+----------------------+ 

+-----------------------------------------------------------------------------------------+ 
| Processes:                                                                              | 
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory | 
|        ID   ID                                                               Usage      | 
|=========================================================================================| 
|    0   N/A  N/A            1690      G   /user                                   120MiB | 
+-----------------------------------------------------------------------------------------+ 
```

这里的 `CUDA Version: 13.0 `指的是该显卡的最高支持CUDA版本，实际安装的可以低于此值。

查看系统级CUDA版本
```
nvcc -V
```
输出示例

```
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2023 NVIDIA Corporation
Built on Fri_Jan__6_16:45:21_PST_2023
Cuda compilation tools, release 12.0, V12.0.140
Build cuda_12.0.r12.0/compiler.32267302_0      // [!code warning]
```
这里显示的系统级CUDA是12.0，也正验证了上文所说。

## 安装PyTorch
测试显卡和CUDA信息

```python
import torch

def get_gpu_info():
    if torch.cuda.is_available():
        device = torch.device("cuda:0")
        gpu_name = torch.cuda.get_device_name(device)
        cuda_version = torch.version.cuda
        pytorch_version = torch.__version__
        total_memory = torch.cuda.get_device_properties(device).total_memory / (1024 ** 3)
        compute_capability = torch.cuda.get_device_capability(device)
        compute_capability_str = f"sm_{compute_capability[0]}{compute_capability[1]}"

        print("=" * 50)
        print(f"GPU 设备: {gpu_name}")
        print(f"CUDA 版本: {cuda_version}")
        print(f"PyTorch 版本: {pytorch_version}")
        print(f"GPU 总内存: {total_memory:.2f} GB")
        print(f"计算能力: {compute_capability_str}")
        print("=" * 50)
        return device
    else:
        print("CUDA 不可用，使用 CPU 进行测试")
        return torch.device("cpu")


if __name__ == "__main__":
    get_gpu_info()
```
输入以上命令，切换到指定虚拟环境后，运行代码，若得到类似输出即可证明torch安装成功
```
==================================================
GPU 设备: NVIDIA GeForce RTX 5060 Ti
CUDA 版本: 12.9
PyTorch 版本: 2.8.0+cu129
GPU 总内存: 15.47 GB
计算能力: sm_120
==================================================
```

更简单的方法是，命令行输入：
```bash
python -c "import torch; print(torch.cuda.is_available())"
```

若输出结果为`True`，则证明配置正确，否则请仔细检查各项兼容性，以及是否安装为GPU版的torch。