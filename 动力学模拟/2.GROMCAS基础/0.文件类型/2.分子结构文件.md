# 分子结构文件

## gro

具有gro文件扩展名的文件包含Gromos87格式的分子结构。通过简单地连接文件，gro文件可以用作轨迹。将尝试从每一帧的标题字符串中读取时间值，该字符串前面应加上`“”`，如下面的示例所示。

**示例**：
```
MD of 2 waters, t= 0.0
    6
    1WATER  OW1    1   0.126   1.624   1.679  0.1227 -0.0580  0.0434
    1WATER  HW2    2   0.190   1.661   1.747  0.8085  0.3191 -0.7791
    1WATER  HW3    3   0.177   1.568   1.613 -0.9045 -2.6469  1.3180
    2WATER  OW1    4   1.275   0.053   0.622  0.2519  0.3140 -0.1734
    2WATER  HW2    5   1.337   0.002   0.680 -1.0641 -1.1349  0.0257
    2WATER  HW3    6   1.326   0.120   0.568  1.9427 -0.8216 -0.0244
   1.82060   1.82060   1.82060
```

1. **标题行（Title String）**
   - **格式**：自由格式字符串，可选。
   - **说明**：第一行是标题行，可以包含任意文本。如果标题行末尾包含 `t=<时间>`，则表示该帧的时间（单位为 ps）。

2. **原子数（Number of Atoms）**
   - **格式**：自由格式整数。
   - **说明**：第二行是系统中原子的总数。

3. **原子坐标行（Atom Lines）**
   - **格式**：固定格式，每行描述一个原子。
   - **说明**：每行包含以下信息：
     - **列 1-5**：残基编号（整数，5位）。
     - **列 6-10**：残基名称（字符串，5字符）。
     - **列 11-15**：原子名称（字符串，5字符）。
     - **列 16-20**：原子编号（整数，5位）。
     - **列 21-28**：X 坐标（浮点数，8位，3位小数）。
     - **列 29-36**：Y 坐标（浮点数，8位，3位小数）。
     - **列 37-44**：Z 坐标（浮点数，8位，3位小数）。
     - **列 45-52**：X 速度（可选，浮点数，8位，4位小数）。
     - **列 53-60**：Y 速度（可选，浮点数，8位，4位小数）。
     - **列 61-68**：Z 速度（可选，浮点数，8位，4位小数）。

4. **盒子向量（Box Vectors）**
   - **格式**：自由格式，空格分隔的实数。
   - **说明**：最后一行描述模拟盒子的向量。通常包含 3 个值（v1(x), v2(y), v3(z)），表示盒子的边长。如果需要描述倾斜盒子，可以包含 9 个值（v1(x), v2(y), v3(z), v1(y), v1(z), v2(x), v2(z), v3(x), v3(y)）。
   - GROMACS 仅支持 `v1(y)=v1(z)=v2(z)=0` 的盒子。

---

请注意，单独的分子或离子（如水或Cl-）被视为残留物。如果您想在不使用GROMACS库的情况下在自己的程序中编写这样的文件，可以使用以下格式：

**C format**

"%5d%-5s%5s%5d%8.3f%8.3f%8.3f%8.4f%8.4f%8.4f"

**Fortran format**

(i5,2a5,i5,3f8.3,3f8.4)

请注意，这是写入的格式，因为在上面的示例中，字段可能没有空格，因此不能用C中的相同格式语句读取。

## pdb

扩展名为pdb的文件是蛋白质数据库文件格式的分子结构文件。蛋白质数据库文件格式描述了分子结构中原子的位置。从ATOM和HEATM记录中读取坐标，直到文件结束或遇到ENDMDL记录。GROMACS程序可以读取和写入CRYST1条目中的模拟框。

pdb格式也可以用作轨迹格式，可以从一个文件中读取或写入由ENDMDL分隔的多个结构。

**示例**：
```
ATOM      1  H1  LYS     1      14.260   6.590  34.480  1.00  0.00
ATOM      2  H2  LYS     1      13.760   5.000  34.340  1.00  0.00
ATOM      3  N   LYS     1      14.090   5.850  33.800  1.00  0.00
ATOM      4  H3  LYS     1      14.920   5.560  33.270  1.00  0.00
...
...
```

## g96

扩展名为g96的文件可以是GROMOS-96初始/最终配置文件或坐标轨迹文件或两者的组合。该文件是固定格式的，所有浮点数都写为15.9（文件可能会变得很大）。GROMACS按给定顺序支持以下数据块：


- Header block:

    - TITLE (mandatory)

- Frame blocks:

    - TIMESTEP (optional)

    - POSITION/POSITIONRED (mandatory)

    - VELOCITY/VELOCITYRED (optional)

    - BOX (optional)